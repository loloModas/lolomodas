// ===== SISTEMA DE SINCRONIZA√á√ÉO =====
function sincronizarComPainel() {
    console.log('üîÑ Sincronizando com painel...');
    
    // Tentar carregar dos dois locais poss√≠veis
    let config = JSON.parse(localStorage.getItem('loloModasConfig'));
    const configPainel = JSON.parse(localStorage.getItem('lojaConfig'));
    const produtosPainel = JSON.parse(localStorage.getItem('lojaProdutos'));
    const bannerPainel = JSON.parse(localStorage.getItem('bannerImagens'));
    
    // Se n√£o tem configura√ß√£o pr√≥pria, criar uma
    if (!config) {
        config = JSON.parse(JSON.stringify(CONFIG_PADRAO));
    }
    
    // Sincronizar com dados do painel se existirem
    if (configPainel) {
        console.log('üé® Sincronizando configura√ß√µes do painel...');
        
        // Mesclar configura√ß√µes
        if (configPainel.cores) config.cores = configPainel.cores;
        if (configPainel.textos) config.textos = configPainel.textos;
        if (configPainel.banner) config.banner = configPainel.banner;
        if (configPainel.tipografia) config.tipografia = configPainel.tipografia;
    }
    
    // Sincronizar produtos do painel
    if (produtosPainel && produtosPainel.length > 0) {
        console.log('üì¶ Sincronizando produtos do painel...');
        config.produtos = produtosPainel;
    }
    
    // Sincronizar imagens do banner
    if (bannerPainel && bannerPainel.length > 0) {
        console.log('üñºÔ∏è Sincronizando banner do painel...');
        config.bannerImages = bannerPainel.map(img => img.src);
    }
    
    // Salvar configura√ß√£o unificada
    localStorage.setItem('loloModasConfig', JSON.stringify(config));
    
    // Aplicar mudan√ßas
    carregarPersonalizacao();
    carregarProdutosPersonalizados();
    criarRolagemTenis();
    
    console.log('‚úÖ Sincroniza√ß√£o completa!');
}

// ===== ATUALIZAR FUN√á√ÉO DE INICIALIZA√á√ÉO =====
document.addEventListener('DOMContentLoaded', function() {
    console.log('üõçÔ∏è Iniciando Lolo Modas...');
    
    // Sincronizar primeiro
    sincronizarComPainel();
    carregarEstado();
    carregarPersonalizacao();
    carregarProdutosPersonalizados();
    
    // Sincronizar a cada 3 segundos
    setInterval(sincronizarComPainel, 3000);
    
    // Event listeners para modais
    document.getElementById('productModal').addEventListener('click', function(e) {
        if (e.target === this) fecharModal();
    });
    
    document.getElementById('carrinhoModal').addEventListener('click', function(e) {
        if (e.target === this) document.getElementById('carrinhoModal').style.display = 'none';
    });
});
